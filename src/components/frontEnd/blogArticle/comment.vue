<template>
  <div class="container">
    <div id="qq">
      <p>有什么想要对作者说的吗?</p>
      <div class="message" contentEditable='true'></div>
      <div class="But">
        <img src="../../../../../../../../qq下载/test_8/static/images/comment/bba_thumb.gif" class='bq'/>
        <span class='submit'>发表</span>
        <!--face begin-->
        <div class="face">
          <ul>
            <li><img src="../../../../../../../../qq下载/test_8/static/images/comment/smilea_thumb.gif" title="呵呵]"></li>
            <li><img src="../../../../../../../../qq下载/test_8/static/images/comment/tootha_thumb.gif" title="嘻嘻]"></li>
            <li><img src="../../../../../../../../qq下载/test_8/static/images/comment/laugh.gif" title="[哈哈]"></li>
            <li><img src="../../../../../../../../qq下载/test_8/static/images/comment/tza_thumb.gif" title="[可爱]"></li>
            <li><img src="../../../../../../../../qq下载/test_8/static/images/comment/kl_thumb.gif" title="[可怜]"></li>
            <li><img src="../../../../../../../../qq下载/test_8/static/images/comment/kbsa_thumb.gif" title="[挖鼻屎]"></li>
            <li><img src="../../../../../../../../qq下载/test_8/static/images/comment/cj_thumb.gif" title="[吃惊]"></li>
            <li><img src="../../../../../../../../qq下载/test_8/static/images/comment/shamea_thumb.gif" title="[害羞]"></li>
            <li><img src="../../../../../../../../qq下载/test_8/static/images/comment/zy_thumb.gif" title="[挤眼]"></li>
            <li><img src="../../../../../../../../qq下载/test_8/static/images/comment/bz_thumb.gif" title="[闭嘴]"></li>
            <li><img src="../../../../../../../../qq下载/test_8/static/images/comment/bs2_thumb.gif" title="[鄙视]"></li>
            <li><img src="../../../../../../../../qq下载/test_8/static/images/comment/lovea_thumb.gif" title="[爱你]"></li>
            <li><img src="../../../../../../../../qq下载/test_8/static/images/comment/sada_thumb.gif" title="[泪]"></li>
            <li><img src="../../../../../../../../qq下载/test_8/static/images/comment/heia_thumb.gif" title="[偷笑]"></li>
            <li><img src="../../../../../../../../qq下载/test_8/static/images/comment/qq_thumb.gif" title="[亲亲]"></li>
            <li><img src="../../../../../../../../qq下载/test_8/static/images/comment/sb_thumb.gif" title="[生病]"></li>
            <li><img src="../../../../../../../../qq下载/test_8/static/images/comment/mb_thumb.gif" title="[太开心]"></li>
            <li><img src="../../../../../../../../qq下载/test_8/static/images/comment/ldln_thumb.gif" title="[懒得理你]"></li>
            <li><img src="../../../../../../../../qq下载/test_8/static/images/comment/yhh_thumb.gif" title="[右哼哼]"></li>
            <li><img src="../../../../../../../../qq下载/test_8/static/images/comment/zhh_thumb.gif" title="[左哼哼]"></li>
            <li><img src="../../../../../../../../qq下载/test_8/static/images/comment/x_thumb.gif" title="[嘘]"></li>
            <li><img src="../../../../../../../../qq下载/test_8/static/images/comment/cry.gif" title="[衰]"></li>
            <li><img src="../../../../../../../../qq下载/test_8/static/images/comment/wq_thumb.gif" title="[委屈]"></li>
            <li><img src="../../../../../../../../qq下载/test_8/static/images/comment/t_thumb.gif" title="[吐]"></li>
            <li><img src="../../../../../../../../qq下载/test_8/static/images/comment/k_thumb.gif" title="[打哈气]"></li>
            <li><img src="../../../../../../../../qq下载/test_8/static/images/comment/bba_thumb.gif" title="[抱抱]"></li>
            <li><img src="../../../../../../../../qq下载/test_8/static/images/comment/angrya_thumb.gif" title="[怒]"></li>
            <li><img src="../../../../../../../../qq下载/test_8/static/images/comment/yw_thumb.gif" title="[疑问]"></li>
            <li><img src="../../../../../../../../qq下载/test_8/static/images/comment/cza_thumb.gif" title="[馋嘴]"></li>
            <li><img src="../../../../../../../../qq下载/test_8/static/images/comment/88_thumb.gif" title="[拜拜]"></li>
            <li><img src="../../../../../../../../qq下载/test_8/static/images/comment/sk_thumb.gif" title="[思考]"></li>
            <li><img src="../../../../../../../../qq下载/test_8/static/images/comment/sweata_thumb.gif" title="[汗]"></li>
            <li><img src="../../../../../../../../qq下载/test_8/static/images/comment/sleepya_thumb.gif" title="[困]"></li>
            <li><img src="../../../../../../../../qq下载/test_8/static/images/comment/sleepa_thumb.gif" title="[睡觉]"></li>
            <li><img src="../../../../../../../../qq下载/test_8/static/images/comment/money_thumb.gif" title="[钱]"></li>
            <li><img src="../../../../../../../../qq下载/test_8/static/images/comment/sw_thumb.gif" title="[失望]"></li>
            <li><img src="../../../../../../../../qq下载/test_8/static/images/comment/cool_thumb.gif" title="[酷]"></li>
            <li><img src="../../../../../../../../qq下载/test_8/static/images/comment/hsa_thumb.gif" title="[花心]"></li>
            <li><img src="../../../../../../../../qq下载/test_8/static/images/comment/hatea_thumb.gif" title="[哼]"></li>
            <li><img src="../../../../../../../../qq下载/test_8/static/images/comment/gza_thumb.gif" title="[鼓掌]"></li>
            <li><img src="../../../../../../../../qq下载/test_8/static/images/comment/dizzya_thumb.gif" title="[晕]"></li>
            <li><img src="../../../../../../../../qq下载/test_8/static/images/comment/bs_thumb.gif" title="[悲伤]"></li>
            <li><img src="../../../../../../../../qq下载/test_8/static/images/comment/crazya_thumb.gif" title="[抓狂]"></li>
            <li><img src="../../../../../../../../qq下载/test_8/static/images/comment/h_thumb.gif" title="[黑线]"></li>
            <li><img src="../../../../../../../../qq下载/test_8/static/images/comment/yx_thumb.gif" title="[阴险]"></li>
            <li><img src="../../../../../../../../qq下载/test_8/static/images/comment/nm_thumb.gif" title="[怒骂]"></li>
            <li><img src="../../../../../../../../qq下载/test_8/static/images/comment/hearta_thumb.gif" title="[心]"></li>
            <li><img src="../../../../../../../../qq下载/test_8/static/images/comment/unheart.gif" title="[伤心]"></li>
            <li><img src="../../../../../../../../qq下载/test_8/static/images/comment/pig.gif" title="[猪头]"></li>
            <li><img src="../../../../../../../../qq下载/test_8/static/images/comment/ok_thumb.gif" title="[ok]"></li>
            <li><img src="../../../../../../../../qq下载/test_8/static/images/comment/ye_thumb.gif" title="[耶]"></li>
            <li><img src="../../../../../../../../qq下载/test_8/static/images/comment/good_thumb.gif" title="[good]"></li>
            <li><img src="../../../../../../../../qq下载/test_8/static/images/comment/no_thumb.gif" title="[不要]"></li>
            <li><img src="../../../../../../../../qq下载/test_8/static/images/comment/z2_thumb.gif" title="[赞]"></li>
            <li><img src="../../../../../../../../qq下载/test_8/static/images/comment/come_thumb.gif" title="[来]"></li>
            <li><img src="../../../../../../../../qq下载/test_8/static/images/comment/sad_thumb.gif" title="[弱]"></li>
            <li><img src="../../../../../../../../qq下载/test_8/static/images/comment/lazu_thumb.gif" title="[蜡烛]"></li>
            <li><img src="../../../../../../../../qq下载/test_8/static/images/comment/clock_thumb.gif" title="[钟]"></li>
            <li><img src="../../../../../../../../qq下载/test_8/static/images/comment/cake.gif" title="[蛋糕]"></li>
            <li><img src="../../../../../../../../qq下载/test_8/static/images/comment/m_thumb.gif" title="[话筒]"></li>
            <li><img src="../../../../../../../../qq下载/test_8/static/images/comment/weijin_thumb.gif" title="[围脖]"></li>
            <li><img src="../../../../../../../../qq下载/test_8/static/images/comment/lxhzhuanfa_thumb.gif" title="[转发]"></li>
            <li><img src="../../../../../../../../qq下载/test_8/static/images/comment/lxhluguo_thumb.gif" title="[路过这儿]"></li>
            <li><img src="../../../../../../../../qq下载/test_8/static/images/comment/bofubianlian_thumb.gif" title="[bofu变脸]"></li>
            <li><img src="../../../../../../../../qq下载/test_8/static/images/comment/gbzkun_thumb.gif" title="[gbz困]"></li>
            <li><img src="../../../../../../../../qq下载/test_8/static/images/comment/boboshengmenqi_thumb.gif" title="[生闷气]"></li>
            <li><img src="../../../../../../../../qq下载/test_8/static/images/comment/chn_buyaoya_thumb.gif" title="[不要啊]"></li>
            <li><img src="../../../../../../../../qq下载/test_8/static/images/comment/daxiongleibenxiong_thumb.gif" title="[dx泪奔]"></li>
            <li><img src="../../../../../../../../qq下载/test_8/static/images/comment/cat_yunqizhong_thumb.gif" title="[运气中]"></li>
            <li><img src="../../../../../../../../qq下载/test_8/static/images/comment/youqian_thumb.gif" title="[有钱]"></li>
          </ul>
        </div>
        <!--face end-->
      </div>
    </div>
    <!--qq end-->
    <!--msgCon begin-->
    <div class="msgCon" ref="msgCon"></div>

  </div>
</template>

<script type="text/javascript">
  import '../../../../../../../../qq下载/test_8/static/js/jquery-1.10.2.min'

  export default {
    name: "comment",
    data() {
      return {
        textarea: ''
      }
    },
    methods() {
      //从缓存中获取数据并渲染
      let msgBoxList = JSON.parse(window.localStorage.getItem('msgBoxList')) || [];
      innerHTMl(msgBoxList)

      //点击小图片，显示
      $(function () {
        $(".bq").click(function (e) {
          $(".face").slideDown(); //慢慢向下展开
          e.stopPropagation(); //阻止冒泡事件
        });
      })


      //在桌面任意地方点击，关闭表情框
      $(document).click(function () {
        $(".face").slideUp(); //慢慢向上收
      });

      //点击小图标时，添加功能
      $(".face ul li").click(function () {
        let simg = $(this).find("img").clone();
        $(".message").append(simg); //将表情添加到输入框
      });

      //点击发表按扭，发表内容
      $("span.submit").click(function () {
        let txt = $(".message").html(); //获取输入框内容
        if (!txt) {
          $('.message').focus(); //自动获取焦点
          return;
        }
        let obj = {
          msg: txt
        }
        msgBoxList.unshift(obj) //添加到数组里
        window.localStorage.setItem('msgBoxList', JSON.stringify(msgBoxList)) //将数据保存到缓存
        innerHTMl([obj]) //渲染当前输入框内容
        $('.message').html('') // 清空输入框

      });

      //删除当前数据
      $("body").on('click', '.del', function () {
        let index = $(this).parent().parent().index();
        msgBoxList.splice(index, 1)
        window.localStorage.setItem('msgBoxList', JSON.stringify(msgBoxList)) //将数据保存到缓存
        $(this).parent().parent().remove()
      })

      //渲染html
      // function innerHTMl(List)
      {
        List = List || []
        List.forEach(item => {
          let str =
            `<div class='msgBox'>
						<div class="headUrl">
							<img src='images/tx.jpg' width='50' height='50'/>
							<div>
								<span class="title">木林森里没有木</span>
								<span class="time">2018-01-01</span>
							</div>
							<a class="del">删除</a>
						</div>
						<div class='msgTxt'>
							${item.msg}
						</div>
					</div>`
          $(".msgCon").prepend(str);
        })
      }

    },

  }

</script>

<style scoped>
  @import "../../../../../../../../qq下载/test_8/static/css/comment/comment.css";
</style>
